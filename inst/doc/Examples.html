<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Examples</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Examples</h1>



<div id="summary" class="section level1">
<h1>Summary</h1>
<p>Exploratory factor analysis (EFA) (Gorsuch, 1983) is a popular
statistical method in many disciplines (e.g., the social and behavioral
sciences, education, and medical sciences). Researchers use EFA to study
constructs (e.g., intelligence, personality traits, and emotion) whose
measurements (e.g., questionnaires and wearable sensors) are often
contaminated with error. These constructs are called latent factors and
their measurements are called observed variables. The latent factors
provide a parsimonious explanation of the relations among observed
variables. EFA involves determining the number factors, extracting the
unrotated factor loading matrix, rotating the matrix, and interpreting
the EFA results. The EFAutilities package utilizes four utility
functions for EFA and related methods. In particular, it computes
standard errors for rotated factor loadings and factor correlations
under a variety of conditions (Browne, 2001; Zhang, 2014).</p>
<p>The R package EFAutilities includes four functions (efa, ssem, efaMR,
and Align.matrix) and two data sets (CPAI537 and BFI228). In the rest of
the vignette, we first describes the functions and the data sets, then
illustrate the functions with several examples.</p>
</div>
<div id="functions" class="section level1">
<h1>Functions</h1>
<p><strong>efa()</strong><br />
The function <code>efa()</code> is the main function in the package. It
conducts EFA with either raw data or a correlation matrix. Four types of
raw data are allowed: normal, non-normal continuous variables, Likert
variables, and time series data. The function allows researcher to
extract factors using either ordinary least squares (OLS) or maximum
likelihood (ML). Both oblique rotation or orthogonal rotation are
available with seven rotation criteria (CF-varimax, CF-quartimax,
CF-facparsim, CF-equamax, CF-parsimax, geomin, and target). These
rotation criteria are a subset of rotation criteria considered in
CEFA3.0 (Browne, Cudeck, Tateneni, &amp; Mels, 2010). A rotation
criterion xtarget is a new development (Zhang, Hattori, Trichtinger,
&amp; Wang, 2018) that allows researchers to specify targets on both
factor loadings and factor correlations. Researchers can choose four
methods (information, sandwich, bootstrap, and jackknife) to estimate
standard errors for rotated factor loadings and factor correlations.</p>
<p><strong>ssem()</strong><br />
The function <code>ssem()</code> is a newly developed method that allows
both exogenous factors and endogenous factors (Zhang, Hattori, and
Trichtinger, in press). All factors are exogenous in EFA, but factors
can be either exogenous or endogenous in this rotation method. We refer
to this new rotation method as FSP (factor simple path). It allows
researchers (1) to explore directional relations among common factors
with flexible factor loading matrices and (2) to reexamine a SEM model
that fit data poorly or encountered estimation problems like Heywood
cases or non-convergence.</p>
<p><strong>efaMR()</strong><br />
The function <code>efaMR()</code> compares EFA results from multiple
random starts or from multiple rotation criteria. Researchers can use it
to assess the computational stability of a rotation method. Hattori,
Zhang, and Preacher (2017) investigate the phenomenon of local solutions
for geomin rotation in a variety of situation. The functions
<code>efaMR()</code> and <code>efa()</code> share many arguments, but it
includes additional ones like <code>input.A</code>,
<code>additionalRC</code>, <code>nstart</code>, <code>compare</code>,
and <code>geomin.delta</code>.</p>
<p><strong>Align.matrix()</strong><br />
The function <code>Align.Matrix()</code> aligns a rotated factor loading
matrix against an order matrix. Researchers can use it resolve the
alignment problem, which refers to the phenomenon that the sign and
ordering of factors are arbitrary in a factor loading matrix. Failing to
resolve the alignment problem has a detrimental effect when comparing
multiple factor analysis results. The function Align.matrix minimizes
the sum of squared deviation between the rotated factor loading matrix
and the order matrix. Because the function considers every possible
ordering of the rotated factor loading matrix, the computational cost
can be high if there are too many factors.</p>
</div>
<div id="data-description" class="section level1">
<h1>Data Description</h1>
<p>This package includes two data sets. The first one includes 228
undergraduate students self ratings on the 44 items in the Big Five
Inventory (John, Donahue, &amp; Kentle, 1991). It is part of a study on
personality and relationship satisfaction (Luo, 2005). The ratings are
five-point Likert items: disagree strongly (1), disagree a little (2),
neither agree nor disagree (3), agree a little (4), and agree strongly
(5). The data are presented as a n by p matrix of ordinal variables,
where n is the number of participants (228) and p is the number of
manifest variables (44).</p>
<p>The second one includes 28 composite scores of the Chinese
personality inventory (Cheung et al., 1996) CPAI537. This data is part
of a study on martial satisfaction (Luo et al., 2008). Participants of
the study were 537 urban Chinese couples within the first year of their
first marriage. The data are composite scores of the 537 wives. The data
are presented as a n by p matrix, where n is the number of participants
(537) and p is the number of manifest variables (28).</p>
</div>
<div id="illustration-examples" class="section level1">
<h1>Illustration Examples</h1>
<p>We illustrate EFAutilities with six examples. Example 1 illustrates
EFA with continuous non-normal data; Example 2 illustrates EFA with
ordinal data; Example 3 illustrates EFA with correlated residuals;
Example 4 illustrates SSEM (FSP); Example 5 illustrates rotation with
multiple random starting points; Example 6 illustrates how to re-align a
rotated factor loading matrix against an order matrix.</p>
<div id="example-1" class="section level2">
<h2>Example 1</h2>
<p>In Example 1, we fit a 4-factor model to the <code>CPAI537</code>
data. We obtained unrotated factor loadings using ml and we conduct
oblique CF-varimax rotation. We compute standard errors for rotated
factor loadings and factor correlations using a sandwich method.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EFAutilities)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;CPAI537&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mnames<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Nov&quot;</span>, <span class="st">&quot;Div&quot;</span>, <span class="st">&quot;Dit&quot;</span>,<span class="st">&quot;LEA&quot;</span>,<span class="st">&quot;L_A&quot;</span>, <span class="st">&quot;AES&quot;</span>, <span class="st">&quot;E_I&quot;</span>, <span class="st">&quot;ENT&quot;</span>, <span class="st">&quot;RES&quot;</span>, <span class="st">&quot;EMO&quot;</span>, <span class="st">&quot;I_S&quot;</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;PRA&quot;</span>, <span class="st">&quot;O_P&quot;</span>, <span class="st">&quot;MET&quot;</span>, <span class="st">&quot;FAC&quot;</span>, <span class="st">&quot;I_E&quot;</span>, <span class="st">&quot;FAM&quot;</span>, <span class="st">&quot;DEF&quot;</span>, <span class="st">&quot;G_M&quot;</span>, <span class="st">&quot;INT&quot;</span>, <span class="st">&quot;S_S&quot;</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;V_S&quot;</span>, <span class="st">&quot;T_M&quot;</span>, <span class="st">&quot;REN&quot;</span>, <span class="st">&quot;SOC&quot;</span>, <span class="st">&quot;DIS&quot;</span>, <span class="st">&quot;HAR&quot;</span>, <span class="st">&quot;T_E&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">efa</span>(<span class="at">x=</span>CPAI537,<span class="at">factors=</span><span class="dv">4</span>, <span class="at">fm=</span><span class="st">&#39;ml&#39;</span>, <span class="at">mnames=</span>mnames)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>res1</span></code></pre></div>
<pre><code>## 
## Summary of Analysis: 
##    Estimation Method:   ml 
##    Rotation Type:   oblique 
##    Rotation Criterion:   CF-varimax 
##    Test Statistic:   545 
##    Degrees of Freedom:   272 
##    Effect numbers of Parameters:   134 
##    P value for perfect fit:   0 
## 
## Rotated Factor Loadings: 
##         F1     F2     F3     F4
## Nov -0.117  0.674  0.146 -0.021
## Div -0.191  0.530  0.386 -0.145
## Dit  0.139  0.461  0.313  0.007
## LEA  0.297  0.672 -0.084 -0.036
## L_A  0.068  0.471  0.176  0.161
## AES  0.128  0.345  0.215 -0.093
## E_I  0.001  0.565 -0.067  0.104
## ENT -0.096  0.536 -0.272  0.425
## RES  0.065  0.004  0.120  0.620
## EMO -0.049  0.030  0.062 -0.750
## I_S  0.440 -0.218 -0.191 -0.461
## PRA  0.025  0.035  0.263  0.505
## O_P -0.159  0.285 -0.009  0.476
## MET  0.175  0.012  0.052  0.537
## FAC  0.311  0.058  0.238 -0.278
## I_E -0.373  0.021 -0.074  0.223
## FAM -0.281 -0.020  0.378  0.375
## DEF  0.636  0.141 -0.174 -0.259
## G_M -0.617 -0.053  0.228  0.236
## INT -0.540  0.204  0.161  0.076
## S_S  0.589  0.209 -0.019 -0.126
## V_S -0.477 -0.121  0.383  0.255
## T_M  0.625 -0.157  0.076  0.263
## REN  0.092  0.036  0.724 -0.073
## SOC  0.139  0.294  0.602 -0.060
## DIS  0.729  0.058  0.298  0.182
## HAR -0.173 -0.029  0.648  0.250
## T_E  0.188 -0.136  0.357  0.075
## 
## Factor Correlations: 
##        F1    F2     F3     F4
## F1  1.000 0.058 -0.144 -0.313
## F2  0.058 1.000  0.207  0.101
## F3 -0.144 0.207  1.000  0.301
## F4 -0.313 0.101  0.301  1.000</code></pre>
<p>The basic output is a brief summary of the analysis, a rotated factor
loading matrix and a factor correlation matrix. We can request more
detailed output using the <code>moredetail</code> option.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> (res1, <span class="at">moredetail=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## Analysis Details: 
##    Number of Manifest Variable:   28 
##    Number of Factors:   4 
##    Sample Size:   537 
##    Manifest Variable Distribution:   normal 
##    Estimation Method:   ml 
##    Rotation Type:   oblique 
##    Rotation Criterion:   CF-varimax 
##    Rotation Standardization:   FALSE 
##    Standard Error:   sandwich 
## 
## Measures of Fit 
##  Root Mean Square Error of Approximation, RMSEA 
##    Point estimate:   0.043 
##    90 % Confidence Intervals:  ( 0.038 , 0.048 ) 
##    Test Statistic:   545 
##    Degrees of Freedom:   272 
##    Effect numbers of Parameters:   134 
##    P value for perfect fit:   0 
##    P value for close fit:   0.984 
## 
## Eigenvalues, SMCs, Communalities, and Unique Variance: 
##      Eval   SMC  Comm  UniV
## Nov 6.705 0.462 0.519 0.481
## Div 4.076 0.458 0.515 0.485
## Dit 2.114 0.372 0.385 0.615
## LEA 1.867 0.493 0.559 0.441
## L_A 1.184 0.368 0.344 0.656
## AES 0.963 0.240 0.207 0.793
## E_I 0.833 0.374 0.327 0.673
## ENT 0.798 0.409 0.480 0.520
## RES 0.761 0.418 0.421 0.579
## EMO 0.700 0.421 0.516 0.484
## I_S 0.648 0.683 0.721 0.279
## PRA 0.618 0.397 0.405 0.595
## O_P 0.608 0.392 0.398 0.602
## MET 0.524 0.274 0.279 0.721
## FAC 0.516 0.268 0.231 0.769
## I_E 0.511 0.245 0.228 0.772
## FAM 0.486 0.548 0.541 0.459
## DEF 0.467 0.639 0.677 0.323
## G_M 0.460 0.618 0.652 0.348
## INT 0.454 0.413 0.427 0.573
## S_S 0.418 0.506 0.465 0.535
## V_S 0.407 0.600 0.623 0.377
## T_M 0.396 0.353 0.361 0.639
## REN 0.345 0.440 0.502 0.498
## SOC 0.318 0.455 0.506 0.494
## DIS 0.296 0.469 0.558 0.442
## HAR 0.272 0.601 0.661 0.339
## T_E 0.255 0.200 0.149 0.851
## 
## Unrotated Factor Loadings: 
##         F1     F2     F3     F4
## Nov  0.308  0.539 -0.341  0.131
## Div  0.386  0.485 -0.175  0.317
## Dit  0.202  0.577 -0.043  0.097
## LEA -0.146  0.658 -0.320 -0.061
## L_A  0.287  0.494 -0.128 -0.034
## AES  0.048  0.433 -0.045  0.122
## E_I  0.161  0.426 -0.339 -0.067
## ENT  0.340  0.273 -0.428 -0.326
## RES  0.499  0.108  0.153 -0.370
## EMO -0.488  0.002 -0.085  0.520
## I_S -0.835 -0.038  0.122  0.092
## PRA  0.537  0.171  0.185 -0.230
## O_P  0.532  0.154 -0.166 -0.252
## MET  0.315  0.142  0.142 -0.373
## FAC -0.274  0.305  0.170  0.185
## I_E  0.397 -0.206 -0.155 -0.067
## FAM  0.719  0.010  0.155 -0.020
## DEF -0.733  0.367  0.022 -0.071
## G_M  0.755 -0.264 -0.039  0.104
## INT  0.593 -0.052 -0.208  0.171
## S_S -0.486  0.467  0.064 -0.081
## V_S  0.750 -0.176  0.132  0.109
## T_M -0.239  0.246  0.374 -0.321
## REN  0.338  0.388  0.385  0.298
## SOC  0.296  0.567  0.195  0.242
## DIS -0.189  0.568  0.398 -0.204
## HAR  0.712  0.173  0.325  0.133
## T_E  0.114  0.147  0.337  0.029
## 
## Rotated Factor Loadings: 
##         F1     F2     F3     F4
## Nov -0.117  0.674  0.146 -0.021
## Div -0.191  0.530  0.386 -0.145
## Dit  0.139  0.461  0.313  0.007
## LEA  0.297  0.672 -0.084 -0.036
## L_A  0.068  0.471  0.176  0.161
## AES  0.128  0.345  0.215 -0.093
## E_I  0.001  0.565 -0.067  0.104
## ENT -0.096  0.536 -0.272  0.425
## RES  0.065  0.004  0.120  0.620
## EMO -0.049  0.030  0.062 -0.750
## I_S  0.440 -0.218 -0.191 -0.461
## PRA  0.025  0.035  0.263  0.505
## O_P -0.159  0.285 -0.009  0.476
## MET  0.175  0.012  0.052  0.537
## FAC  0.311  0.058  0.238 -0.278
## I_E -0.373  0.021 -0.074  0.223
## FAM -0.281 -0.020  0.378  0.375
## DEF  0.636  0.141 -0.174 -0.259
## G_M -0.617 -0.053  0.228  0.236
## INT -0.540  0.204  0.161  0.076
## S_S  0.589  0.209 -0.019 -0.126
## V_S -0.477 -0.121  0.383  0.255
## T_M  0.625 -0.157  0.076  0.263
## REN  0.092  0.036  0.724 -0.073
## SOC  0.139  0.294  0.602 -0.060
## DIS  0.729  0.058  0.298  0.182
## HAR -0.173 -0.029  0.648  0.250
## T_E  0.188 -0.136  0.357  0.075
## 
## Factor Correlations: 
##        F1    F2     F3     F4
## F1  1.000 0.058 -0.144 -0.313
## F2  0.058 1.000  0.207  0.101
## F3 -0.144 0.207  1.000  0.301
## F4 -0.313 0.101  0.301  1.000
## 
## Unique Variances: 
##   Nov   Div   Dit   LEA   L_A   AES   E_I   ENT   RES   EMO   I_S   PRA   O_P 
## 0.481 0.485 0.615 0.441 0.656 0.793 0.673 0.520 0.579 0.484 0.279 0.595 0.602 
##   MET   FAC   I_E   FAM   DEF   G_M   INT   S_S   V_S   T_M   REN   SOC   DIS 
## 0.721 0.769 0.772 0.459 0.323 0.348 0.573 0.535 0.377 0.639 0.498 0.494 0.442 
##   HAR   T_E 
## 0.339 0.851 
## 
## SE for rotated Factor Loadings: 
##        F1    F2    F3    F4
## Nov 0.036 0.036 0.051 0.043
## Div 0.039 0.053 0.056 0.041
## Dit 0.044 0.051 0.058 0.047
## LEA 0.046 0.033 0.053 0.041
## L_A 0.043 0.044 0.054 0.048
## AES 0.050 0.055 0.061 0.055
## E_I 0.041 0.042 0.050 0.059
## ENT 0.039 0.057 0.043 0.063
## RES 0.043 0.038 0.047 0.044
## EMO 0.036 0.040 0.038 0.031
## I_S 0.046 0.036 0.042 0.042
## PRA 0.051 0.040 0.046 0.044
## O_P 0.044 0.048 0.043 0.051
## MET 0.045 0.043 0.049 0.048
## FAC 0.049 0.055 0.056 0.057
## I_E 0.046 0.048 0.053 0.054
## FAM 0.058 0.038 0.050 0.045
## DEF 0.049 0.035 0.054 0.043
## G_M 0.051 0.037 0.053 0.045
## INT 0.040 0.042 0.047 0.046
## S_S 0.049 0.049 0.062 0.055
## V_S 0.060 0.038 0.055 0.043
## T_M 0.045 0.041 0.048 0.049
## REN 0.043 0.048 0.034 0.042
## SOC 0.040 0.052 0.045 0.040
## DIS 0.037 0.035 0.046 0.043
## HAR 0.053 0.039 0.040 0.041
## T_E 0.055 0.056 0.053 0.064
## 
## SE for Factor Correlations: 
##       F1    F2    F3    F4
## F1 0.000 0.038 0.033 0.028
## F2 0.038 0.000 0.034 0.037
## F3 0.033 0.034 0.000 0.034
## F4 0.028 0.037 0.034 0.000
## 
## SE for Unique Variances: 
##   Nov   Div   Dit   LEA   L_A   AES   E_I   ENT   RES   EMO   I_S   PRA   O_P 
## 0.021 0.023 0.021 0.023 0.021 0.019 0.022 0.029 0.022 0.021 0.017 0.020 0.021 
##   MET   FAC   I_E   FAM   DEF   G_M   INT   S_S   V_S   T_M   REN   SOC   DIS 
## 0.022 0.020 0.018 0.020 0.017 0.017 0.020 0.020 0.020 0.025 0.023 0.023 0.024 
##   HAR   T_E 
## 0.019 0.019 
## 
## Lower Bounds of 95 % CIs for Rotated Factor Loadings: 
##         F1     F2     F3     F4
## Nov -0.187  0.603  0.047 -0.105
## Div -0.267  0.427  0.275 -0.226
## Dit  0.052  0.360  0.199 -0.084
## LEA  0.206  0.607 -0.188 -0.117
## L_A -0.016  0.386  0.071  0.067
## AES  0.029  0.238  0.097 -0.200
## E_I -0.080  0.482 -0.165 -0.012
## ENT -0.172  0.424 -0.357  0.301
## RES -0.019 -0.071  0.027  0.534
## EMO -0.120 -0.048 -0.013 -0.812
## I_S  0.350 -0.287 -0.274 -0.544
## PRA -0.075 -0.044  0.172  0.419
## O_P -0.245  0.192 -0.094  0.376
## MET  0.087 -0.073 -0.044  0.443
## FAC  0.216 -0.049  0.127 -0.389
## I_E -0.462 -0.073 -0.178  0.118
## FAM -0.395 -0.095  0.280  0.288
## DEF  0.541  0.072 -0.280 -0.343
## G_M -0.717 -0.125  0.124  0.149
## INT -0.618  0.121  0.068 -0.014
## S_S  0.493  0.113 -0.140 -0.233
## V_S -0.594 -0.196  0.275  0.170
## T_M  0.537 -0.238 -0.019  0.166
## REN  0.009 -0.057  0.658 -0.155
## SOC  0.061  0.192  0.514 -0.138
## DIS  0.656 -0.011  0.208  0.097
## HAR -0.278 -0.104  0.568  0.169
## T_E  0.080 -0.245  0.252 -0.052
## 
## Upper Bounds of 95 % CIs for Rotated Factor Loadings: 
##         F1     F2     F3     F4
## Nov -0.046  0.744  0.246  0.064
## Div -0.114  0.634  0.496 -0.065
## Dit  0.226  0.561  0.427  0.098
## LEA  0.388  0.738  0.021  0.045
## L_A  0.153  0.557  0.281  0.255
## AES  0.227  0.452  0.334  0.013
## E_I  0.081  0.648  0.031  0.219
## ENT -0.020  0.649 -0.187  0.549
## RES  0.148  0.079  0.212  0.706
## EMO  0.023  0.109  0.137 -0.688
## I_S  0.530 -0.148 -0.109 -0.379
## PRA  0.126  0.113  0.355  0.591
## O_P -0.073  0.378  0.076  0.575
## MET  0.264  0.097  0.149  0.630
## FAC  0.406  0.165  0.348 -0.167
## I_E -0.283  0.115  0.031  0.328
## FAM -0.166  0.055  0.476  0.463
## DEF  0.732  0.211 -0.068 -0.175
## G_M -0.517  0.019  0.332  0.324
## INT -0.463  0.286  0.254  0.167
## S_S  0.685  0.306  0.101 -0.019
## V_S -0.360 -0.046  0.491  0.339
## T_M  0.712 -0.077  0.170  0.360
## REN  0.176  0.129  0.790  0.008
## SOC  0.217  0.396  0.691  0.018
## DIS  0.803  0.128  0.387  0.268
## HAR -0.068  0.047  0.727  0.330
## T_E  0.296 -0.027  0.461  0.201
## 
## Lower Bounds of 95 % CIs for Factor Correlations: 
##        F1     F2     F3     F4
## F1  1.000 -0.017 -0.208 -0.368
## F2 -0.017  1.000  0.139  0.028
## F3 -0.208  0.139  1.000  0.233
## F4 -0.368  0.028  0.233  1.000
## 
## Upper Bounds of 95 % CIs for Factor Correlations: 
##        F1    F2     F3     F4
## F1  1.000 0.133 -0.078 -0.256
## F2  0.133 1.000  0.272  0.174
## F3 -0.078 0.272  1.000  0.367
## F4 -0.256 0.174  0.367  1.000
## 
## Lower Bounds of 95 % CIs for Unique Variances: 
##   Nov   Div   Dit   LEA   L_A   AES   E_I   ENT   RES   EMO   I_S   PRA   O_P 
## 0.440 0.441 0.573 0.396 0.614 0.754 0.630 0.464 0.536 0.443 0.247 0.555 0.560 
##   MET   FAC   I_E   FAM   DEF   G_M   INT   S_S   V_S   T_M   REN   SOC   DIS 
## 0.677 0.726 0.735 0.420 0.291 0.316 0.534 0.495 0.339 0.589 0.453 0.449 0.395 
##   HAR   T_E 
## 0.303 0.809 
## 
## Upper Bounds of 95 % CIs for Unique Variances: 
##   Nov   Div   Dit   LEA   L_A   AES   E_I   ENT   RES   EMO   I_S   PRA   O_P 
## 0.521 0.530 0.654 0.486 0.695 0.827 0.714 0.575 0.621 0.526 0.313 0.635 0.642 
##   MET   FAC   I_E   FAM   DEF   G_M   INT   S_S   V_S   T_M   REN   SOC   DIS 
## 0.762 0.806 0.805 0.497 0.358 0.382 0.611 0.573 0.417 0.687 0.542 0.539 0.489 
##   HAR   T_E 
## 0.377 0.884</code></pre>
<p>We can access even more detailed results by the <code>$</code>
command. For example, we can examine the test statistic and measures of
model fit using the following commands:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>res1<span class="sc">$</span>ModelF</span></code></pre></div>
<pre><code>## $f.stat
## Discrepancy 
##         545 
## 
## $df
## [1] 272
## 
## $n
## [1] 537
## 
## $RMSEA
## Discrepancy 
##      0.0432 
## 
## $p.perfect
## Discrepancy 
##           0 
## 
## $p.close
## Discrepancy 
##       0.984 
## 
## $confid.level
## [1] 0.9
## 
## $RMSEA.l
## [1] 0.0379
## 
## $RMSEA.u
## [1] 0.0485
## 
## $ECVI
## Discrepancy 
##        1.51 
## 
## $ECVI.l
## [1] 1.42
## 
## $ECVI.u
## [1] 1.68</code></pre>
</div>
<div id="example-2" class="section level2">
<h2>Example 2</h2>
<p>In Example 2, we fit a 2-factor model to the data
<code>BFI228</code>. The data contains 5-point Likert variables. We
first estimate polychoric correlations from the Likert variable. We then
obtain the unrotated factor loading matrix from the polychoric
correlation matrix using ols. We conduct oblique geomin rotation. We
compute standard errors using a sandwich method. The efa model involve
only 17 variables out of 44 variables for the illustration purpose.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BFI228&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>reduced2 <span class="ot">&lt;-</span> BFI228[,<span class="dv">1</span><span class="sc">:</span><span class="dv">17</span>]</span></code></pre></div>
<p>Since the data use Likert variables, we set the argument
<code>dist</code> to be <code>ordinal</code>. We can also include an
argument for model error. By default, an efa model is a parsimonious
representation to the complex real world. Thus, we expect some amount of
model error. However, users can specify <code>merror=&#39;NO&#39;</code>, if
they believe their efa model fits perfectly in the population.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mnames<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;talkative&quot;</span>, <span class="st">&quot;reserved_R&quot;</span>, <span class="st">&quot;fullenergy&quot;</span>, <span class="st">&quot;enthusiastic&quot;</span>, <span class="st">&quot;quiet_R&quot;</span>,<span class="st">&quot;assertive&quot;</span>, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;shy_R&quot;</span>, <span class="st">&quot;outgoing&quot;</span>, <span class="st">&quot;findfault_R&quot;</span>, <span class="st">&quot;helpful&quot;</span>, <span class="st">&quot;quarrels_R&quot;</span>, <span class="st">&quot;forgiving&quot;</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;trusting&quot;</span>, <span class="st">&quot;cold_R&quot;</span>, <span class="st">&quot;considerate&quot;</span>, <span class="st">&quot;rude_R&quot;</span>, <span class="st">&quot;cooperative&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span><span class="fu">efa</span>(<span class="at">x=</span>reduced2, <span class="at">factors=</span><span class="dv">2</span>, <span class="at">dist=</span><span class="st">&quot;ordinal&quot;</span>, <span class="at">rotation=</span><span class="st">&quot;geomin&quot;</span>, <span class="at">merror=</span><span class="st">&quot;YES&quot;</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">mnames=</span>mnames)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>res2</span></code></pre></div>
<pre><code>## 
## Summary of Analysis: 
##    Estimation Method:   ols 
##    Rotation Type:   oblique 
##    Rotation Criterion:   geomin 
##    Test Statistic:   298 
##    Degrees of Freedom:   103 
##    Effect numbers of Parameters:   50 
##    P value for perfect fit:   0 
## 
## Rotated Factor Loadings: 
##                  F1     F2
## talkative     0.772 -0.036
## reserved_R   -0.589 -0.021
## fullenergy    0.588  0.378
## enthusiastic  0.662  0.361
## quiet_R      -0.854  0.078
## assertive     0.635 -0.025
## shy_R        -0.704  0.096
## outgoing      0.792  0.165
## findfault_R  -0.057 -0.520
## helpful      -0.031  0.591
## quarrels_R    0.123 -0.726
## forgiving     0.040  0.611
## trusting      0.108  0.629
## cold_R       -0.102 -0.744
## considerate  -0.131  0.759
## rude_R        0.078 -0.713
## cooperative   0.181  0.634
## 
## Factor Correlations: 
##       F1    F2
## F1 1.000 0.209
## F2 0.209 1.000</code></pre>
</div>
<div id="example-3" class="section level2">
<h2>Example 3</h2>
<p>In Example 3, we illustrate EFA with correlated residuals. The data
is a subset of the study reported by Watson Clark &amp; Tellegen, A.
(1988). The original data set contains 20 items, but we consider only 8
items.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a> xcor <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.00</span>,  <span class="fl">0.37</span>,  <span class="fl">0.29</span>,  <span class="fl">0.43</span>, <span class="sc">-</span><span class="fl">0.07</span>, <span class="sc">-</span><span class="fl">0.05</span>, <span class="sc">-</span><span class="fl">0.04</span>, <span class="sc">-</span><span class="fl">0.01</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.37</span>,  <span class="fl">1.00</span>,  <span class="fl">0.51</span>,  <span class="fl">0.37</span>, <span class="sc">-</span><span class="fl">0.03</span>, <span class="sc">-</span><span class="fl">0.03</span>, <span class="sc">-</span><span class="fl">0.06</span>, <span class="sc">-</span><span class="fl">0.03</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.29</span>,  <span class="fl">0.51</span>,  <span class="fl">1.00</span>,  <span class="fl">0.37</span>, <span class="sc">-</span><span class="fl">0.03</span>, <span class="sc">-</span><span class="fl">0.01</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.04</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.43</span>,  <span class="fl">0.37</span>,  <span class="fl">0.37</span>,  <span class="fl">1.00</span>, <span class="sc">-</span><span class="fl">0.03</span>, <span class="sc">-</span><span class="fl">0.03</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.01</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a> <span class="sc">-</span><span class="fl">0.07</span>, <span class="sc">-</span><span class="fl">0.03</span>, <span class="sc">-</span><span class="fl">0.03</span>, <span class="sc">-</span><span class="fl">0.03</span>,  <span class="fl">1.00</span>,  <span class="fl">0.61</span>,  <span class="fl">0.41</span>,  <span class="fl">0.32</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a> <span class="sc">-</span><span class="fl">0.05</span>, <span class="sc">-</span><span class="fl">0.03</span>, <span class="sc">-</span><span class="fl">0.01</span>, <span class="sc">-</span><span class="fl">0.03</span>,  <span class="fl">0.61</span>,  <span class="fl">1.00</span>,  <span class="fl">0.47</span>,  <span class="fl">0.38</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a> <span class="sc">-</span><span class="fl">0.04</span>, <span class="sc">-</span><span class="fl">0.06</span>, <span class="sc">-</span><span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.02</span>,  <span class="fl">0.41</span>,  <span class="fl">0.47</span>,  <span class="fl">1.00</span>,  <span class="fl">0.47</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a> <span class="sc">-</span><span class="fl">0.01</span>, <span class="sc">-</span><span class="fl">0.03</span>, <span class="sc">-</span><span class="fl">0.04</span>, <span class="sc">-</span><span class="fl">0.01</span>,  <span class="fl">0.32</span>,  <span class="fl">0.38</span>,  <span class="fl">0.47</span>,  <span class="fl">1.00</span>),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a> <span class="at">ncol=</span><span class="dv">8</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a> n.cr<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a> I.cr <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n.cr,<span class="dv">2</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a> I.cr[<span class="dv">1</span>,<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a> I.cr[<span class="dv">1</span>,<span class="dv">2</span>] <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a> I.cr[<span class="dv">2</span>,<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">7</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a> I.cr[<span class="dv">2</span>,<span class="dv">2</span>] <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a> <span class="fu">efa</span>(<span class="at">covmat=</span>xcor,<span class="at">factors=</span><span class="dv">2</span>, <span class="at">n.obs=</span><span class="dv">1657</span>, <span class="at">I.cr=</span>I.cr)</span></code></pre></div>
<pre><code>## 
## Summary of Analysis: 
##    Estimation Method:   ols 
##    Rotation Type:   oblique 
##    Rotation Criterion:   CF-varimax 
##    Test Statistic:   87.6 
##    Degrees of Freedom:   11 
##    Effect numbers of Parameters:   25 
##    P value for perfect fit:   0 
## 
## Rotated Factor Loadings: 
##         F1     F2
## MV1 -0.030  0.557
## MV2 -0.004  0.695
## MV3  0.011  0.637
## MV4  0.003  0.610
## MV5  0.780 -0.022
## MV6  0.949  0.008
## MV7  0.494 -0.029
## MV8  0.393 -0.015
## 
## Factor Correlations: 
##        F1     F2
## F1  1.000 -0.049
## F2 -0.049  1.000</code></pre>
</div>
<div id="example-4" class="section level2">
<h2>Example 4</h2>
<p>In Example 4, we illustrate FSP with a correlation matrix
(Reisenzein, 1986). The original study was on an attribution theory of
helping behaviors. The sample size was 138. The SSEM involves 9 manifest
variables and 3 latent factors. We expect that an uncontrollable need
results in sympathy toward the help-seeker and sympathy further leads to
helping behavior. Therefore, we denote the two factors “helping
behavior” and “sympathy” as endogenous and the factor “controllability”
as exogenous.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>cormat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">865</span>, .<span class="dv">733</span>, .<span class="dv">511</span>, .<span class="dv">412</span>, .<span class="dv">647</span>, <span class="sc">-</span>.<span class="dv">462</span>, <span class="sc">-</span>.<span class="dv">533</span>, <span class="sc">-</span>.<span class="dv">544</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                  .<span class="dv">865</span>, <span class="dv">1</span>, .<span class="dv">741</span>, .<span class="dv">485</span>, .<span class="dv">366</span>, .<span class="dv">595</span>, <span class="sc">-</span>.<span class="dv">406</span>, <span class="sc">-</span>.<span class="dv">474</span>, <span class="sc">-</span>.<span class="dv">505</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                  .<span class="dv">733</span>, .<span class="dv">741</span>, <span class="dv">1</span>, .<span class="dv">316</span>, .<span class="dv">268</span>, .<span class="dv">497</span>, <span class="sc">-</span>.<span class="dv">303</span>, <span class="sc">-</span>.<span class="dv">372</span>, <span class="sc">-</span>.<span class="dv">44</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                  .<span class="dv">511</span>, .<span class="dv">485</span>, .<span class="dv">316</span>, <span class="dv">1</span>, .<span class="dv">721</span>, .<span class="dv">731</span>, <span class="sc">-</span>.<span class="dv">521</span>, <span class="sc">-</span>.<span class="dv">531</span>, <span class="sc">-</span>.<span class="dv">621</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                  .<span class="dv">412</span>, .<span class="dv">366</span>, .<span class="dv">268</span>, .<span class="dv">721</span>, <span class="dv">1</span>, .<span class="dv">599</span>, <span class="sc">-</span>.<span class="dv">455</span>, <span class="sc">-</span>.<span class="dv">425</span>, <span class="sc">-</span>.<span class="dv">455</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                  .<span class="dv">647</span>, .<span class="dv">595</span>, .<span class="dv">497</span>, .<span class="dv">731</span>, .<span class="dv">599</span>, <span class="dv">1</span>, <span class="sc">-</span>.<span class="dv">417</span>, <span class="sc">-</span>.<span class="dv">47</span>, <span class="sc">-</span>.<span class="dv">521</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                 <span class="sc">-</span>.<span class="dv">462</span>, <span class="sc">-</span>.<span class="dv">406</span>, <span class="sc">-</span>.<span class="dv">303</span>, <span class="sc">-</span>.<span class="dv">521</span>, <span class="sc">-</span>.<span class="dv">455</span>, <span class="sc">-</span>.<span class="dv">417</span>, <span class="dv">1</span>, .<span class="dv">747</span>, .<span class="dv">727</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                 <span class="sc">-</span>.<span class="dv">533</span>, <span class="sc">-</span>.<span class="dv">474</span>, <span class="sc">-</span>.<span class="dv">372</span>, <span class="sc">-</span>.<span class="dv">531</span>, <span class="sc">-</span>.<span class="dv">425</span>, <span class="sc">-</span>.<span class="dv">47</span>, .<span class="dv">747</span>, <span class="dv">1</span>, .<span class="dv">772</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                 <span class="sc">-</span>.<span class="dv">544</span>, <span class="sc">-</span>.<span class="dv">505</span>, <span class="sc">-</span>.<span class="dv">44</span>, <span class="sc">-</span>.<span class="dv">621</span>, <span class="sc">-</span>.<span class="dv">455</span>, <span class="sc">-</span>.<span class="dv">521</span>, .<span class="dv">727</span>, .<span class="dv">772</span>, <span class="dv">1</span>),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncol =</span> <span class="dv">9</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">138</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>mvnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;H1_likelihood&quot;</span>, <span class="st">&quot;H2_certainty&quot;</span>, <span class="st">&quot;H3_amount&quot;</span>, <span class="st">&quot;S1_sympathy&quot;</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;S2_pity&quot;</span>, <span class="st">&quot;S3_concern&quot;</span>, <span class="st">&quot;C1_controllable&quot;</span>, <span class="st">&quot;C2_responsible&quot;</span>, <span class="st">&quot;C3_fault&quot;</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>fnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;H&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;C&quot;</span>)</span></code></pre></div>
<p>Next, we want to prepare our target and weight matrices based on our
theory. For the target matrix, a 9 indicates a value that is allowed to
be freely estimated. We set the other values to be rotation as close to
0 as possible. The weight matrix has 1 in the places where the target
matrix has zeros and otherwise zero.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a 9 x 3 matrix for lambda; p = 9, m = 3</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>MT <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, p, m, <span class="at">dimnames =</span> <span class="fu">list</span>(mvnames, fnames))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>MT[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">6</span>),<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>MT[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>MT[<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>MW <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, p, m, <span class="at">dimnames =</span> <span class="fu">list</span>(mvnames, fnames))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>MW[MT <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># a 2 x 3 matrix for [B|G]; m1 = 2, m = 3</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>BGT <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m1, m, <span class="at">dimnames =</span> <span class="fu">list</span>(fnames[<span class="dv">1</span><span class="sc">:</span>m1], fnames))</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>BGT[<span class="dv">1</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>BGT[<span class="dv">2</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>BGT[<span class="dv">1</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>BGW <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m1, m, <span class="at">dimnames =</span> <span class="fu">list</span>(fnames[<span class="dv">1</span><span class="sc">:</span>m1], fnames))</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>BGW[BGT <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>BGW[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>BGW[<span class="dv">2</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># a 1 x 1 matrix for Phi.xi; m - m1 = 1 (only one exogenous factor)</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>PhiT <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">9</span>, m <span class="sc">-</span> m1, m <span class="sc">-</span> m1)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>PhiW <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m <span class="sc">-</span> m1, m <span class="sc">-</span> m1)</span></code></pre></div>
<p>We can then run the ssem function by</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>SSEMres <span class="ot">&lt;-</span> <span class="fu">ssem</span>(<span class="at">covmat =</span> cormat, <span class="at">factors =</span> m, <span class="at">exfactors =</span> m <span class="sc">-</span> m1,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="at">dist =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">n.obs =</span> N, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>, <span class="at">rotation =</span> <span class="st">&quot;semtarget&quot;</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="at">maxit =</span> <span class="dv">10000</span>, <span class="at">MTarget =</span> MT, <span class="at">MWeight =</span> MW, <span class="at">BGTarget =</span> BGT, <span class="at">BGWeight =</span> BGW,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="at">PhiTarget =</span> PhiT, <span class="at">PhiWeight =</span> PhiW,  <span class="at">useorder =</span> <span class="cn">TRUE</span>, <span class="at">se =</span> <span class="st">&quot;information&quot;</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="at">mnames =</span> mvnames, <span class="at">fnames =</span> fnames)</span></code></pre></div>
<pre><code>## The fisher information SEs are valid only for normal data and no model error. Sandwich SEs are computed.</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>SSEMres</span></code></pre></div>
<pre><code>## 
## Summary of Analysis: 
##    Estimation Method:   ml 
##    Rotation Criterion:   semtarget 
##    Test Statistic:   12.8 
##    Degrees of Freedom:   12 
##    Effect numbers of Parameters:   33 
##    P value for perfect fit:   0.386 
## 
## Rotated Factor Loadings: 
##                      H      S      C
## H1_likelihood    0.877  0.049 -0.057
## H2_certainty     0.912  0.047  0.021
## H3_amount        0.849 -0.100 -0.003
## S1_sympathy      0.008  0.927 -0.039
## S2_pity          0.004  0.728 -0.039
## S3_concern       0.384  0.621  0.078
## C1_controllable  0.063  0.005  0.880
## C2_responsible  -0.025  0.068  0.920
## C3_fault        -0.051 -0.096  0.779
## 
## Latent Regression Weights: 
##   H     S      C
## H 0 0.224 -0.427
## S 0 0.000 -0.641
## 
## Latent Residual Variances: 
##     H     S 
## 0.645 0.589 
## 
## Exogenous Factor Correlations: 
##   C
## C 1</code></pre>
</div>
<div id="example-5" class="section level2">
<h2>Example 5</h2>
<p>In Example 5, we use the <code>efaMR</code> to compare EFA solutions
from 100 random orthogonal starts. We fit a 5-factor model to the data
``CPAI537’ data fit then obtain the unrotated factor loading matrix from
using ml. We conduct oblique geomin rotation.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>efaMRres <span class="ot">&lt;-</span><span class="fu">efaMR</span>(CPAI537, <span class="at">factors =</span> <span class="dv">5</span>, <span class="at">fm =</span><span class="st">&#39;ml&#39;</span>, <span class="at">rtype =</span><span class="st">&#39;oblique&#39;</span>, <span class="at">rotation =</span><span class="st">&#39;geomin&#39;</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">geomin.delta =</span> .<span class="dv">01</span>, <span class="at">nstart =</span> <span class="dv">100</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#res3$MultipleSolutions for more details</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>efaMRres<span class="sc">$</span>MultipleSolutions<span class="sc">$</span>FrequenciesSolutions</span></code></pre></div>
<pre><code>## [1] 23 10 44 14  6  2  1</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>efaMRres<span class="sc">$</span>MultipleSolutions<span class="sc">$</span>Solutions[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## $Lambda
##         [,1]   [,2]   [,3]   [,4]   [,5]
##  [1,]  0.641 -0.062  0.229  0.010  0.125
##  [2,]  0.492 -0.275  0.321  0.010  0.106
##  [3,]  0.386 -0.225  0.035  0.002  0.275
##  [4,]  0.661  0.028 -0.089 -0.285  0.089
##  [5,]  0.412 -0.066  0.016  0.152  0.272
##  [6,]  0.235 -0.127  0.074 -0.107  0.331
##  [7,]  0.727 -0.016 -0.025 -0.011 -0.316
##  [8,]  0.610  0.296 -0.055  0.328 -0.061
##  [9,] -0.005  0.004 -0.274  0.661  0.195
## [10,] -0.027 -0.125  0.361 -0.730 -0.026
## [11,] -0.265  0.026 -0.163 -0.719  0.032
## [12,]  0.035 -0.149 -0.198  0.596  0.136
## [13,]  0.340  0.084 -0.049  0.523 -0.029
## [14,]  0.013  0.014 -0.327  0.493  0.152
## [15,]  0.044 -0.328 -0.099 -0.371 -0.020
## [16,]  0.016  0.202  0.199  0.390  0.052
## [17,]  0.077 -0.306  0.010  0.632 -0.209
## [18,]  0.124 -0.023 -0.345 -0.648  0.024
## [19,] -0.013 -0.059  0.336  0.615 -0.096
## [20,]  0.187  0.017  0.422  0.372  0.053
## [21,]  0.055  0.008 -0.269 -0.416  0.477
## [22,] -0.113 -0.194  0.244  0.632  0.013
## [23,] -0.083 -0.247 -0.652  0.004 -0.129
## [24,]  0.019 -0.676 -0.004  0.106  0.035
## [25,]  0.318 -0.608 -0.025  0.018 -0.048
## [26,]  0.041 -0.385 -0.579 -0.071  0.149
## [27,] -0.007 -0.512  0.039  0.548  0.002
## [28,] -0.227 -0.267 -0.123  0.138  0.289
## 
## $Phi
##        [,1]   [,2]   [,3]   [,4]   [,5]
## [1,]  1.000 -0.231 -0.128  0.105  0.317
## [2,] -0.231  1.000 -0.090 -0.143 -0.263
## [3,] -0.128 -0.090  1.000  0.295 -0.123
## [4,]  0.105 -0.143  0.295  1.000 -0.025
## [5,]  0.317 -0.263 -0.123 -0.025  1.000</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>efaMRres<span class="sc">$</span>MultipleSolutions<span class="sc">$</span>Solutions[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>## $Lambda
##         [,1]   [,2]   [,3]   [,4]   [,5]
##  [1,]  0.594 -0.042  0.129 -0.032  0.243
##  [2,]  0.451 -0.243  0.274  0.055  0.234
##  [3,]  0.337 -0.075 -0.053  0.196  0.332
##  [4,]  0.626  0.023 -0.389 -0.050  0.158
##  [5,]  0.363  0.104 -0.002  0.163  0.314
##  [6,]  0.186 -0.067 -0.070  0.057  0.382
##  [7,]  0.734 -0.005 -0.094  0.015 -0.240
##  [8,]  0.592  0.399  0.020 -0.006 -0.033
##  [9,] -0.022  0.409  0.064  0.475  0.104
## [10,] -0.031 -0.520 -0.026 -0.449  0.086
## [11,] -0.251 -0.219 -0.563 -0.256  0.007
## [12,]  0.021  0.239  0.125  0.504  0.074
## [13,]  0.329  0.308  0.199  0.216 -0.032
## [14,]  0.002  0.362 -0.088  0.419  0.061
## [15,]  0.048 -0.335 -0.298  0.120 -0.004
## [16,]  0.004  0.229  0.411 -0.072  0.066
## [17,]  0.096 -0.006  0.436  0.467 -0.221
## [18,]  0.127 -0.120 -0.772 -0.068  0.003
## [19,] -0.012  0.049  0.745  0.111 -0.059
## [20,]  0.162  0.024  0.628 -0.069  0.139
## [21,]  0.006  0.052 -0.625  0.030  0.450
## [22,] -0.118  0.011  0.666  0.275  0.024
## [23,] -0.049  0.046 -0.632  0.524 -0.262
## [24,]  0.013 -0.418  0.110  0.529  0.054
## [25,]  0.310 -0.386 -0.004  0.458  0.002
## [26,]  0.037 -0.036 -0.655  0.590  0.053
## [27,] -0.010 -0.156  0.412  0.582 -0.002
## [28,] -0.248 -0.044 -0.039  0.347  0.242
## 
## $Phi
##        [,1]   [,2]   [,3]  [,4]   [,5]
## [1,]  1.000 -0.041  0.124 0.292  0.288
## [2,] -0.041  1.000  0.232 0.020 -0.226
## [3,]  0.124  0.232  1.000 0.343 -0.055
## [4,]  0.292  0.020  0.343 1.000  0.253
## [5,]  0.288 -0.226 -0.055 0.253  1.000</code></pre>
<p>The output displays the multiple factoring loadings and factor
correlations matrix for the unique solutions found. Also, the
comparisons should the minimum congruence and raw congruences.</p>
</div>
<div id="example-6" class="section level2">
<h2>Example 6</h2>
<p>In Example 6, we illustrate how to align a factor loading matrix to
an order matrix using the <code>Align.Matix</code> function. In
addition, we align the factor correlation matrix accordingly. Let’s
consider a 4-by-2 factor loading matrix. The order matrix, A, is also a
4-by-2 matrix. We form the 6-by-2 input matrix, B, by stacking the
factor loading matrix and factor correlation matrix together. The first
4 rows contain the factor loading matrix and the last 2 rows contain the
factor correlation matrix.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Order Matrix</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.8</span>,<span class="fl">0.6</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span>),<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Input.Matrix</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="fl">0.8</span>,<span class="sc">-</span><span class="fl">0.7</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.2</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="fl">0.2</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">6</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Align.Matrix</span>(<span class="at">Order.Matrix=</span>A, <span class="at">Input.Matrix=</span>B)</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,] 0.80  0.0
## [2,] 0.70  0.0
## [3,] 0.00  0.8
## [4,] 0.00  0.7
## [5,] 1.00  0.2
## [6,] 0.20  1.0
## [7,] 0.01  0.0</code></pre>
<p>The output is a 7-by-2 matrix (p+m+1-by-m). The first p rows of the
output matrix are factor loadings of the best match, the next m rows are
factor correlations of the best match, and the last row contains
information of the sums of squared deviations of the best match.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Browne, M. W. (2001). An overview of analytic rotation in exploratory
factor analysis. Multivariate Behavioral Research, 36, 111–150. :
10.1207/s15327906mbr3601_05</p>
<p>Browne, M. W., Cudeck, R., Tateneni, K., &amp; Mels, G. (2010). CEFA
3.04: Comprehensive Exploratory Factor Analysis.</p>
<p>Cheung, F. M., Leung, K., Fan, R., Song, W., Zhang, J., &amp; Zhang,
J. (1996). Development of the Chinese Personality Assessment Inventory
(CPAI). Journal of Cross-Cultural Psychology, 27, 181–199. :
10.1177/0022022196272003</p>
<p>Gorsuch, R. L. (1983). Factor analysis (2nd ed.). Mahwah, NJ:
Lawrence Erlbaum Associates. : 10.4324/9780203781098</p>
<p>Hattori, M., Zhang, G., &amp; Preacher, K. J. (2017). Multiple local
solutions and geomin rotation. Multivariate Behavioral Research, 52,
720–731. : 10.1080/00273171.2017.1361312</p>
<p>John, O. P., Donahue, E. M., &amp; Kentle, R. L. (1991). The Big Five
Inventory – versions 4a and 54. Berkeley, CA: University of California,
Berkeley, Institute of Personality and Social Research. :
10.1037/t07550-000</p>
<p>Luo, S. (2005). Personality and relationship satisfaction.
(unpublished studies)</p>
<p>Luo, S., Chen, H., Yue, G., Zhang, G., Zhaoyang, R., &amp; Xu, D.
(2008). Predicting marital satisfaction from self, partner, and couple
characteristics: Is it me, you, or us? Journal of Personality, 76,
1231–1266. : doi.org/10.1111/j.1467-6494.2008.00520.x</p>
<p>Resenzein, R. (1986). A structural equation analysis of Weiner’s
attribution–affect model of helping behavior. Journal of Personality and
Social Psychology,50, 1123–1133. :10.1037/0022-3514.50.6.1123</p>
<p>Zhang, G. (2014). Estimating standard errors in exploratory factor
analysis. Multivariate Behavioral Research, 49, 339–353. :
10.1080/00273171.2014.908271</p>
<p>Zhang, G., Hattori, M., Trichtinger, L., &amp; Wang, X. (2018).
Target rotation with both factor loadings and factor correlations.
Psychological Methods. : 10.1037/met0000198</p>
<p>Zhang, G., Hattori, M., Trichtinger, L (In press). Rotating factors
to simplify their structural paths. Psychometrika. DOI:
10.1007/s11336-022-09877-3</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
